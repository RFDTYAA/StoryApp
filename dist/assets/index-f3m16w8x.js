(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();const k=(n,e)=>e.some(t=>n instanceof t);let _,M;function W(){return _||(_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function G(){return M||(M=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const T=new WeakMap,I=new WeakMap,b=new WeakMap;function z(n){const e=new Promise((t,r)=>{const o=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(p(n.result)),o()},a=()=>{r(n.error),o()};n.addEventListener("success",i),n.addEventListener("error",a)});return b.set(e,n),e}function q(n){if(T.has(n))return;const e=new Promise((t,r)=>{const o=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),o()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});T.set(n,e)}let P={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return T.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return p(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function j(n){P=n(P)}function F(n){return G().includes(n)?function(...e){return n.apply(D(this),e),p(this.request)}:function(...e){return p(n.apply(D(this),e))}}function K(n){return typeof n=="function"?F(n):(n instanceof IDBTransaction&&q(n),k(n,W())?new Proxy(n,P):n)}function p(n){if(n instanceof IDBRequest)return z(n);if(I.has(n))return I.get(n);const e=K(n);return e!==n&&(I.set(n,e),b.set(e,n)),e}const D=n=>b.get(n);function J(n,e,{blocked:t,upgrade:r,blocking:o,terminated:i}={}){const a=indexedDB.open(n,e),s=p(a);return r&&a.addEventListener("upgradeneeded",d=>{r(p(a.result),d.oldVersion,d.newVersion,p(a.transaction),d)}),t&&a.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),s.then(d=>{i&&d.addEventListener("close",()=>i()),o&&d.addEventListener("versionchange",c=>o(c.oldVersion,c.newVersion,c))}).catch(()=>{}),s}const Y=["get","getKey","getAll","getAllKeys","count"],Z=["put","add","delete","clear"],B=new Map;function O(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(B.get(e))return B.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,o=Z.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(o||Y.includes(t)))return;const i=async function(a,...s){const d=this.transaction(a,o?"readwrite":"readonly");let c=d.store;return r&&(c=c.index(s.shift())),(await Promise.all([c[t](...s),o&&d.done]))[0]};return B.set(e,i),i}j(n=>({...n,get:(e,t,r)=>O(e,t)||n.get(e,t,r),has:(e,t)=>!!O(e,t)||n.has(e,t)}));const Q=["continue","continuePrimaryKey","advance"],x={},A=new WeakMap,H=new WeakMap,X={get(n,e){if(!Q.includes(e))return n[e];let t=x[e];return t||(t=x[e]=function(...r){A.set(this,H.get(this)[e](...r))}),t}};async function*ee(...n){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...n)),!e)return;e=e;const t=new Proxy(e,X);for(H.set(t,e),b.set(t,D(e));e;)yield t,e=await(A.get(t)||e.continue()),A.delete(t)}function N(n,e){return e===Symbol.asyncIterator&&k(n,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&k(n,[IDBIndex,IDBObjectStore])}j(n=>({...n,get(e,t,r){return N(e,t)?ee:n.get(e,t,r)},has(e,t){return N(e,t)||n.has(e,t)}}));const te="story-app-db",ne=1,g="stories",v=J(te,ne,{upgrade(n){n.objectStoreNames.contains(g)||n.createObjectStore(g,{keyPath:"id"})}}),E={async getAllStories(){return(await v).getAll(g)},async getStory(n){return(await v).get(g,n)},async putStory(n){return(await v).put(g,n)},async deleteStory(n){return(await v).delete(g,n)}};function m(n=""){return String(n).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}class oe{constructor(){this.map=null}render(){const e=document.getElementById("app-content");e&&(e.innerHTML=`
      <div class="home-container">
        <h2>Daftar Cerita</h2>
        <div id="map-home" style="height:320px;margin-bottom:16px"></div>
        <div id="stories-container"></div>
      </div>
    `)}showLoading(){const e=document.getElementById("app-content"),t=document.createElement("p");t.id="home-loading",t.textContent="Memuat cerita...",e.prepend(t)}hideLoading(){const e=document.getElementById("home-loading");e&&e.remove()}async renderStories(e=[]){const t=document.getElementById("stories-container");if(!t)return;t.innerHTML="";const r=document.createElement("div");r.className="story-list",e.forEach(o=>{var w,f;const i=m(o.id||o._id||`id-${Date.now()}`),a=m(o.name||o.title||"Tanpa Judul"),s=m(o.description||""),d=m(o.photoUrl||o.photo||"/icons/icon-192x192.png"),c=m(o.createdAt||""),l=o.lat??o.latitude??((w=o.location)==null?void 0:w.lat)??null,h=o.lon??o.longitude??((f=o.location)==null?void 0:f.lon)??null,u=document.createElement("div");u.className="card",u.innerHTML=`
        <img src="${d}" alt="${a}" />
        <div class="card-content">
          <h3>${a}</h3>
          <p>${s}</p>
          <small>${c}</small>
          <div style="margin-top:12px;">
            <button class="save-offline-btn" data-id="${i}">Simpan Offline</button>
          </div>
        </div>
      `,r.appendChild(u),u.querySelector(".save-offline-btn").addEventListener("click",async()=>{await E.putStory({id:i,name:a,description:s,photoUrl:d,createdAt:c||new Date().toISOString(),lat:l,lon:h}),this.showSuccess("Cerita disimpan offline!")})}),t.appendChild(r)}renderMap(e=[]){const t=document.getElementById("map-home");if(!t)return;if(this.map){try{this.map.off(),this.map.remove()}catch{}this.map=null}const r=[-2.5489,118.0149];try{this.map=L.map(t).setView(r,5)}catch{this.map=L.map(t.id).setView(r,5)}L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(this.map),e.forEach(o=>{var s,d;const i=o.lat??o.latitude??((s=o.location)==null?void 0:s.lat),a=o.lon??o.longitude??((d=o.location)==null?void 0:d.lon);if(i!=null&&a!=null)try{L.marker([Number(i),Number(a)]).addTo(this.map).bindPopup(`<strong>${m(o.name||"")}</strong><br>${m(o.description||"")}`)}catch(c){console.warn("Marker fail",c)}}),setTimeout(()=>{try{this.map.invalidateSize()}catch{}},200)}showError(e){const t=document.getElementById("stories-container")||document.getElementById("app-content");t&&(t.innerHTML=`<div class="form-container"><p style="color:red; font-weight:bold;">Error: ${m(e)}</p></div>`)}showSuccess(e){const t=document.createElement("div");t.style="position:fixed;top:80px;right:20px;background:#2ecc71;color:#fff;padding:10px;border-radius:6px;z-index:10000;",t.innerText=e,document.body.appendChild(t),setTimeout(()=>t.remove(),3e3)}}class C{constructor(){const e=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";this.API_ENDPOINT=e?"/api/v1":"https://story-api.dicoding.dev/v1"}getToken(){return localStorage.getItem("token")}async getStories(){const e=this.getToken();if(!e)throw new Error("Anda harus login untuk melihat cerita.");try{const t=await fetch(`${this.API_ENDPOINT}/stories`,{headers:{Authorization:`Bearer ${e}`}});if(!t.ok){const o=await t.json().catch(()=>({}));throw new Error(o.message||"Gagal memuat cerita dari API.")}return(await t.json()).listStory||[]}catch(t){throw t}}async addStory(e){const t=this.getToken();if(!t)throw new Error("Anda harus login untuk menambah cerita.");const r=await fetch(`${this.API_ENDPOINT}/stories`,{method:"POST",headers:{Authorization:`Bearer ${t}`},body:e}),o=await r.json().catch(()=>({}));if(!r.ok)throw new Error(o.message||"Gagal menambahkan cerita.");return o}async saveStoryOffline(e){return e.id||(e.id=`local-${Date.now()}`),await E.putStory(e),e}async getSavedStories(){return await StoryDb.getAllStories()}async deleteSavedStory(e){return await StoryDb.deleteStory(e)}}class V{constructor(e,t){this.model=e,this.view=t}async addStory(e){try{this.view.showLoading();const t=await this.model.addStory(e),r=t&&t.story?t.story:t;try{await this.model.saveStoryOffline({id:r.id||`srv-${Date.now()}`,name:r.name||"Cerita",description:r.description||e.get("description"),lat:e.get("lat"),lon:e.get("lon"),photoUrl:r.photoUrl||r.photo||"",createdAt:new Date().toISOString()})}catch(o){console.warn("Gagal menyimpan salinan offline:",o)}this.view.showSuccess("Cerita berhasil ditambahkan!"),setTimeout(()=>{window.location.hash="#/home"},900)}catch(t){this.view.showError(t.message||"Gagal menambahkan cerita.")}finally{this.view.hideLoading()}}}class re{constructor(){this._mediaStream=null,this.map=null,this.marker=null}render(){document.getElementById("app-content").innerHTML=`
      <div class="add-story-container">
        <h2>Tambah Cerita Baru</h2>
        <form id="add-story-form">
          <div class="form-group">
            <label for="description">Deskripsi Cerita</label>
            <textarea id="description" name="description" required></textarea>
          </div>

          <div class="form-group">
            <label>Ambil Gambar dari Kamera</label>
            <video id="camera-preview" autoplay muted playsinline></video>
            <canvas id="photo-canvas" style="display:none;"></canvas>
            <button type="button" id="capture-btn">Ambil Gambar</button>
            <img id="photo-result" style="max-width: 100%; margin-top: 10px; display: none;" />
          </div>

          <div class="form-group">
            <label>Pilih Lokasi di Peta</label>
            <div id="map-picker" style="height: 300px; width: 100%;"></div>
            <input type="hidden" id="latitude" name="lat">
            <input type="hidden" id="longitude" name="lon">
          </div>
          
          <button type="submit" id="submit-story-btn">Unggah Cerita</button>
          <p id="upload-status" class="upload-status"></p>
        </form>
      </div>
    `,this._initializeCamera(),this._initializeMap(),this._addEventListeners(),window.addEventListener("hashchange",()=>this.cleanup()),window.addEventListener("beforeunload",()=>this.cleanup())}async _initializeCamera(){try{this._mediaStream=await navigator.mediaDevices.getUserMedia({video:!0});const e=document.getElementById("camera-preview");e.srcObject=this._mediaStream}catch(e){console.error("Gagal mengakses kamera:",e),alert("Tidak dapat mengakses kamera. Pastikan Anda memberikan izin.")}}_initializeMap(){const e=[-2.5489,118.0149];this.map=L.map("map-picker").setView(e,5),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(this.map),this.marker=L.marker(e,{draggable:!0}).addTo(this.map),this._updateCoordinates(e[0],e[1]),this.map.on("click",t=>{const{lat:r,lng:o}=t.latlng;this.marker.setLatLng([r,o]),this._updateCoordinates(r,o)}),this.marker.on("dragend",()=>{const{lat:t,lng:r}=this.marker.getLatLng();this._updateCoordinates(t,r)})}_updateCoordinates(e,t){document.getElementById("latitude").value=e,document.getElementById("longitude").value=t}_addEventListeners(){document.getElementById("capture-btn").addEventListener("click",()=>{const t=document.getElementById("camera-preview"),r=document.getElementById("photo-canvas"),o=document.getElementById("photo-result");r.width=t.videoWidth,r.height=t.videoHeight,r.getContext("2d").drawImage(t,0,0),o.src=r.toDataURL("image/jpeg"),o.style.display="block"}),document.getElementById("add-story-form").addEventListener("submit",t=>{t.preventDefault();const r=new C,o=new V(r,this),i=document.getElementById("description").value,a=document.getElementById("latitude").value,s=document.getElementById("longitude").value,d=document.getElementById("photo-canvas");if(d.toDataURL()===document.createElement("canvas").toDataURL()){this.showError("Silakan ambil gambar terlebih dahulu.");return}d.toBlob(c=>{const l=new FormData;l.append("description",i),l.append("lat",a),l.append("lon",s),l.append("photo",c,"story.jpg"),o.addStory(l)},"image/jpeg")})}showLoading(){document.getElementById("upload-status").innerText="Mengunggah...",document.getElementById("upload-status").style.color="black",document.getElementById("submit-story-btn").disabled=!0}hideLoading(){document.getElementById("upload-status").innerText="",document.getElementById("submit-story-btn").disabled=!1}showSuccess(e){document.getElementById("upload-status").innerText=e,document.getElementById("upload-status").style.color="green"}showError(e){document.getElementById("upload-status").innerText=`Error: ${e}`,document.getElementById("upload-status").style.color="red"}_stopCamera(){this._mediaStream&&(this._mediaStream.getTracks().forEach(e=>e.stop()),this._mediaStream=null,console.log("Kamera dimatikan."))}cleanup(){this._stopCamera(),this.map&&(this.map.remove(),this.map=null)}}class U{constructor(){this.API_ENDPOINT="https://story-api.dicoding.dev/v1"}async login(e,t){const r=await fetch(`${this.API_ENDPOINT}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),o=await r.json();if(!r.ok)throw new Error(o.message||"Login gagal, periksa email dan password.");return localStorage.setItem("token",o.loginResult.token),localStorage.setItem("name",o.loginResult.name),o}async register(e,t,r){const o=await fetch(`${this.API_ENDPOINT}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,password:r})}),i=await o.json();if(!o.ok)throw new Error(i.message||"Registrasi gagal.");return i}}const ie=Object.freeze(Object.defineProperty({__proto__:null,AuthModel:U},Symbol.toStringTag,{value:"Module"})),ae=()=>!!localStorage.getItem("token");function S(){const n=document.getElementById("nav-home"),e=document.getElementById("nav-add"),t=document.getElementById("nav-saved"),r=document.getElementById("nav-login"),o=document.getElementById("nav-register"),i=document.getElementById("nav-logout");if(!n&&!e&&!t&&!r&&!o&&!i){console.warn("updateNavbar: elemen navbar belum tersedia di DOM.");return}ae()?(n&&(n.style.display="list-item"),e&&(e.style.display="list-item"),t&&(t.style.display="list-item"),i&&(i.style.display="list-item"),r&&(r.style.display="none"),o&&(o.style.display="none")):(n&&(n.style.display="none"),e&&(e.style.display="none"),t&&(t.style.display="none"),i&&(i.style.display="none"),r&&(r.style.display="list-item"),o&&(o.style.display="list-item"))}function se(){const n=document.getElementById("logout-button");n&&n.addEventListener("click",e=>{e.preventDefault(),localStorage.removeItem("token"),localStorage.removeItem("name"),S(),window.location.hash="#/login"})}class de{constructor(e,t){this.model=e,this.view=t}async login(e,t){try{const r=await this.model.login(e,t);this.view.showSuccess(`Selamat datang, ${r.loginResult.name}`),S(),window.location.hash="#/home"}catch(r){this.view.showError(r.message)}}}class ce{render(){const e=document.getElementById("app-content");e.innerHTML=`
      <h2>Login</h2>
      <label for="email">Email</label>
      <input type="email" id="email" placeholder="Email" />
      <label for="password">Password</label>
      <input type="password" id="password" placeholder="Password" />
      <button id="loginBtn">Masuk</button>
      <p id="loginStatus"></p>
    `,this.afterRender()}async afterRender(){const e=new U,t=new de(e,this);document.getElementById("loginBtn").addEventListener("click",()=>{const r=document.getElementById("email").value,o=document.getElementById("password").value;t.login(r,o)})}showSuccess(e){const t=document.getElementById("loginStatus");t?(t.textContent=e,t.style.color="green"):console.error("Elemen #loginStatus tidak ditemukan di halaman login")}showError(e){const t=document.getElementById("loginStatus");t?(t.textContent=`Gagal: ${e}`,t.style.color="red"):console.error("Elemen #loginStatus tidak ditemukan di halaman login")}}const le="modulepreload",ue=function(n){return"/"+n},$={},me=function(e,t,r){let o=Promise.resolve();if(t&&t.length>0){let a=function(c){return Promise.all(c.map(l=>Promise.resolve(l).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),d=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));o=a(t.map(c=>{if(c=ue(c),c in $)return;$[c]=!0;const l=c.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":le,l||(u.as="script"),u.crossOrigin="",u.href=c,d&&u.setAttribute("nonce",d),document.head.appendChild(u),l)return new Promise((w,f)=>{u.addEventListener("load",w),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a}return o.then(a=>{for(const s of a||[])s.status==="rejected"&&i(s.reason);return e().catch(i)})};class he{constructor(e,t){this.model=e,this.view=t}async register(e,t,r){try{const o=await this.model.register(e,t,r);this.view.showSuccess("Registrasi berhasil. Silakan login."),setTimeout(()=>window.location.hash="#/login",900)}catch(o){this.view.showError(o.message||"Gagal registrasi.")}}}class pe{constructor(){this.presenter=null}render(){const e=document.getElementById("app-content");e.innerHTML=`
      <div class="form-container">
        <h2>Daftar</h2>
        <label for="name">Nama</label>
        <input id="reg-name" type="text" />
        <label for="email">Email</label>
        <input id="reg-email" type="email" />
        <label for="password">Password</label>
        <input id="reg-password" type="password" />
        <button id="reg-btn">Daftar</button>
        <p id="reg-status"></p>
      </div>
    `,this.afterRender()}afterRender(){me(async()=>{const{AuthModel:e}=await Promise.resolve().then(()=>ie);return{AuthModel:e}},void 0).then(({AuthModel:e})=>{this.presenter=new he(new e,this),document.getElementById("reg-btn").addEventListener("click",()=>{const t=document.getElementById("reg-name").value,r=document.getElementById("reg-email").value,o=document.getElementById("reg-password").value;this.presenter.register(t,r,o)})})}showSuccess(e){const t=document.getElementById("reg-status");t&&(t.style.color="green",t.textContent=e)}showError(e){const t=document.getElementById("reg-status");t&&(t.style.color="red",t.textContent=e)}}class ge{async render(){document.getElementById("app-content").innerHTML=`
      <section class="saved-stories">
        <h2>Saved Stories</h2>
        <div id="saved-list" class="story-list"></div>
      </section>
    `,await this._loadStories()}async _loadStories(){const e=await E.getAllStories(),t=document.getElementById("saved-list");if(!e.length){t.innerHTML="<p>Tidak ada cerita tersimpan.</p>";return}e.forEach(r=>{const o=document.createElement("div");o.classList.add("card"),o.innerHTML=`
        <img src="${r.photoUrl}" alt="${r.description}">
        <div class="card-content">
          <h3>${r.name}</h3>
          <p>${r.description}</p>
          <small>${r.createdAt}</small>
          <button class="delete-btn" data-id="${r.id}">Hapus</button>
        </div>
      `,t.appendChild(o)}),this._addDeleteListeners()}_addDeleteListeners(){document.querySelectorAll(".delete-btn").forEach(e=>{e.addEventListener("click",async t=>{const r=t.target.dataset.id;await E.deleteStory(r),await this._loadStories()})})}}class ye{constructor(e,t){this.model=e,this.view=t}async loadStories(){this.view.showLoading&&this.view.showLoading();try{const e=await this.model.getStories();await this.view.renderStories(e),await this.view.renderMap(e)}catch(e){try{const t=await this.model.getSavedStories();t&&t.length>0?(await this.view.renderStories(t),await this.view.renderMap(t),this.view.showError&&this.view.showError("Menampilkan cerita lokal (offline).")):this.view.showError&&this.view.showError(e.message||"Gagal memuat cerita. Periksa koneksi internet Anda.")}catch{this.view.showError&&this.view.showError(e.message||"Gagal memuat cerita. Periksa koneksi internet Anda.")}}finally{this.view.hideLoading&&this.view.hideLoading()}}async saveStoryForOffline(e){try{await this.model.saveStoryOffline(e),this.view.showSuccess&&this.view.showSuccess("Cerita disimpan offline.")}catch{this.view.showError&&this.view.showError("Gagal menyimpan offline.")}}}const R=()=>{const n=window.location.hash||"#/home";if(S(),n==="#/home"||n==="#/"){const e=new oe;e.render();const t=new C,r=new ye(t,e);window.app=window.app||{},window.app.storyPresenter=r,r.loadStories()}else if(n==="#/add"){const e=new re;e.render();const t=new C,r=new V(t,e);window.app=window.app||{},window.app.addPresenter=r}else n==="#/login"?new ce().render():n==="#/register"?new pe().render():n==="#/saved"?new ge().render():window.location.hash="#/home"};function y(n,e=3e3){const t=document.createElement("div");t.className="toast",t.textContent=n,document.body.appendChild(t),setTimeout(()=>t.classList.add("show"),50),setTimeout(()=>{t.classList.remove("show"),setTimeout(()=>document.body.removeChild(t),300)},e)}const we={async init(){if(console.log("ðŸ”” Inisialisasi Notification Helper..."),!("Notification"in window)){y("Browser tidak mendukung notifikasi","error");return}await Notification.requestPermission()==="granted"?this._subscribeToPush():y("Izin notifikasi ditolak","error")},async _subscribeToPush(){try{const n=await navigator.serviceWorker.ready,e={userVisibleOnly:!0,applicationServerKey:this._urlBase64ToUint8Array("BLXy8gNJ5aM-xIf9hvC5oT2TvZf7PMq6ZbeAWSq_-DyUMva6S6T1qfKTIWyA2NYORYHxCpNuFkN34yHa0px549Q")},t=await n.pushManager.subscribe(e);console.log("Push Subscription:",JSON.stringify(t)),y("Berhasil berlangganan push notification","success")}catch(n){console.error("Gagal berlangganan push notification:",n),y("Gagal berlangganan push notification","error")}},_urlBase64ToUint8Array(n){const e="=".repeat((4-n.length%4)%4),t=(n+e).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(t),o=new Uint8Array(r.length);for(let i=0;i<r.length;++i)o[i]=r.charCodeAt(i);return o}};document.addEventListener("DOMContentLoaded",()=>{S(),se(),R(),window.addEventListener("hashchange",R),"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(()=>{console.log("Service Worker berhasil didaftarkan."),we.init(),navigator.serviceWorker.addEventListener("message",n=>{n.data&&n.data.type==="SHOW_TOAST"&&y(`${n.data.title}: ${n.data.body}`,"success")})}).catch(n=>{console.error("Pendaftaran Service Worker gagal:",n)})});
